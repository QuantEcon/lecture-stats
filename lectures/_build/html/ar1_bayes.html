

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>9. Posterior Distributions for AR(1) Parameters &#8212; Statistics for Computational Economics</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=fb55226d87c9bac2266479caf30be1337b66f140" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=eed9c059a3ee152aae2353ec732f0a6d12e6aa07"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ar1_bayes';</script>
    <link rel="canonical" href="https://python.quantecon.org/ar1_bayes.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="10. Forecasting an AR(1) Process" href="ar1_turningpts.html" />
    <link rel="prev" title="8. Non-Conjugate Priors" href="bayes_nonconj.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent and John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on statistics for computational economics. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Posterior Distributions for  AR(1) Parameters"/>
<meta name="twitter:description" content="This website presents a set of lectures on statistics for computational economics.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Posterior Distributions for  AR(1) Parameters" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/ar1_bayes.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on statistics for computational economics." />
<meta property="og:site_name" content="Statistics for Computational Economics" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=ar1_bayes>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pymc-implementation">9.1. PyMC Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numpyro-implementation">9.2. Numpyro Implementation</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Statistics for Computational Economics</a></p>

                        <p class="qe-page__header-subheading">Posterior Distributions for  AR(1) Parameters</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="posterior-distributions-for-ar-1-parameters">
<h1><span class="section-number">9. </span>Posterior Distributions for  AR(1) Parameters<a class="headerlink" href="#posterior-distributions-for-ar-1-parameters" title="Permalink to this heading">#</a></h1>
<p>We’ll begin with some Python imports.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>arviz<span class="w"> </span>pymc<span class="w"> </span>numpyro<span class="w"> </span>jax
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: The directory &#39;/Users/humphreyyang/Library/Caches/pip&#39; or its parent directory is not owned or is not writable by the current user. The cache has been disabled. Check the permissions and owner of that directory. If executing pip with sudo, you should use sudo&#39;s -H flag.</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: arviz in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (0.13.0)
Requirement already satisfied: pymc in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (5.8.1)
Requirement already satisfied: numpyro in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (0.13.0)
Requirement already satisfied: jax in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (0.4.19)
Requirement already satisfied: setuptools&gt;=60.0.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (68.0.0)
Requirement already satisfied: matplotlib&gt;=3.5 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (3.7.1)
Requirement already satisfied: numpy&gt;=1.20.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (1.24.3)
Requirement already satisfied: scipy&gt;=1.8.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (1.10.1)
Requirement already satisfied: packaging in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (21.3)
Requirement already satisfied: pandas&gt;=1.4.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (1.5.3)
Requirement already satisfied: xarray&gt;=0.21.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (2023.6.0)
Requirement already satisfied: netcdf4 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (1.6.4)
Requirement already satisfied: typing-extensions&gt;=4.1.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (4.7.1)
Requirement already satisfied: xarray-einstats&gt;=0.3 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from arviz) (0.6.0)
Requirement already satisfied: cachetools&gt;=4.2.1 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pymc) (5.3.1)
Requirement already satisfied: cloudpickle in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pymc) (2.2.1)
Requirement already satisfied: fastprogress&gt;=0.2.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pymc) (1.0.3)
Requirement already satisfied: pytensor&lt;2.17,&gt;=2.16.1 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pymc) (2.16.1)
Requirement already satisfied: jaxlib&gt;=0.4.14 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from numpyro) (0.4.19)
Requirement already satisfied: multipledispatch in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from numpyro) (0.6.0)
Requirement already satisfied: tqdm in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from numpyro) (4.65.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: ml-dtypes&gt;=0.2.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from jax) (0.2.0)
Requirement already satisfied: opt-einsum in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from jax) (3.3.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from matplotlib&gt;=3.5-&gt;arviz) (1.0.5)
Requirement already satisfied: cycler&gt;=0.10 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from matplotlib&gt;=3.5-&gt;arviz) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from matplotlib&gt;=3.5-&gt;arviz) (4.25.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from matplotlib&gt;=3.5-&gt;arviz) (1.4.4)
Requirement already satisfied: pillow&gt;=6.2.0 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from matplotlib&gt;=3.5-&gt;arviz) (9.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from matplotlib&gt;=3.5-&gt;arviz) (3.0.9)
Requirement already satisfied: python-dateutil&gt;=2.7 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from matplotlib&gt;=3.5-&gt;arviz) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pandas&gt;=1.4.0-&gt;arviz) (2022.7)
Requirement already satisfied: filelock in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pytensor&lt;2.17,&gt;=2.16.1-&gt;pymc) (3.9.0)
Requirement already satisfied: etuples in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pytensor&lt;2.17,&gt;=2.16.1-&gt;pymc) (0.3.9)
Requirement already satisfied: logical-unification in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pytensor&lt;2.17,&gt;=2.16.1-&gt;pymc) (0.4.6)
Requirement already satisfied: miniKanren in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pytensor&lt;2.17,&gt;=2.16.1-&gt;pymc) (1.0.3)
Requirement already satisfied: cons in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from pytensor&lt;2.17,&gt;=2.16.1-&gt;pymc) (0.4.6)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: six in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from multipledispatch-&gt;numpyro) (1.16.0)
Requirement already satisfied: cftime in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from netcdf4-&gt;arviz) (1.6.2)
Requirement already satisfied: certifi in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from netcdf4-&gt;arviz) (2023.7.22)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: toolz in /Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages (from logical-unification-&gt;pytensor&lt;2.17,&gt;=2.16.1-&gt;pymc) (0.12.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv</span>

</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pmc</span>
<span class="kn">import</span> <span class="nn">numpyro</span>
<span class="kn">from</span> <span class="nn">numpyro</span> <span class="kn">import</span> <span class="n">distributions</span> <span class="k">as</span> <span class="n">dist</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;pymc&#39;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">CRITICAL</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This lecture uses Bayesian methods offered by <a class="reference external" href="https://www.pymc.io/projects/docs/en/stable/">pymc</a> and <a class="reference external" href="https://num.pyro.ai/en/stable/">numpyro</a> to make statistical inferences about two parameters of a univariate first-order autoregression.</p>
<p>The model is a good laboratory for illustrating
consequences of alternative ways of modeling the distribution of the initial  <span class="math notranslate nohighlight">\(y_0\)</span>:</p>
<ul class="simple">
<li><p>As a fixed number</p></li>
<li><p>As a random variable drawn from the stationary distribution of the <span class="math notranslate nohighlight">\(\{y_t\}\)</span> stochastic process</p></li>
</ul>
<p>The first component of the statistical model is</p>
<div class="math notranslate nohighlight" id="equation-eq-themodel">
<span class="eqno">(9.1)<a class="headerlink" href="#equation-eq-themodel" title="Permalink to this equation">#</a></span>\[
y_{t+1} = \rho y_t + \sigma_x \epsilon_{t+1}, \quad t \geq 0
\]</div>
<p>where the scalars <span class="math notranslate nohighlight">\(\rho\)</span> and <span class="math notranslate nohighlight">\(\sigma_x\)</span> satisfy <span class="math notranslate nohighlight">\(|\rho| &lt; 1\)</span> and <span class="math notranslate nohighlight">\(\sigma_x &gt; 0\)</span>;
<span class="math notranslate nohighlight">\(\{\epsilon_{t+1}\}\)</span> is a sequence of i.i.d. normal random variables with mean <span class="math notranslate nohighlight">\(0\)</span> and variance <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>The second component of the statistical model is</p>
<div class="math notranslate nohighlight" id="equation-eq-themodel-2">
<span class="eqno">(9.2)<a class="headerlink" href="#equation-eq-themodel-2" title="Permalink to this equation">#</a></span>\[
y_0 \sim {\cal N}(\mu_0, \sigma_0^2)
\]</div>
<p>Consider a sample <span class="math notranslate nohighlight">\(\{y_t\}_{t=0}^T\)</span> governed by this statistical model.</p>
<p>The model
implies that the likelihood function of <span class="math notranslate nohighlight">\(\{y_t\}_{t=0}^T\)</span> can be <strong>factored</strong>:</p>
<div class="math notranslate nohighlight">
\[
f(y_T, y_{T-1}, \ldots, y_0) = f(y_T| y_{T-1}) f(y_{T-1}| y_{T-2}) \cdots f(y_1 | y_0 ) f(y_0)
\]</div>
<p>where we use <span class="math notranslate nohighlight">\(f\)</span> to denote a generic probability density.</p>
<p>The  statistical model <a class="reference internal" href="#equation-eq-themodel">(9.1)</a>-<a class="reference internal" href="#equation-eq-themodel-2">(9.2)</a> implies</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
f(y_t | y_{t-1})  &amp; \sim {\mathcal N}(\rho y_{t-1}, \sigma_x^2) \\
        f(y_0)  &amp; \sim {\mathcal N}(\mu_0, \sigma_0^2)
\end{aligned}
\end{split}\]</div>
<p>We want to study how inferences about the unknown parameters <span class="math notranslate nohighlight">\((\rho, \sigma_x)\)</span> depend on what is assumed about the parameters <span class="math notranslate nohighlight">\(\mu_0, \sigma_0\)</span>  of the distribution of <span class="math notranslate nohighlight">\(y_0\)</span>.</p>
<p>Below, we study two widely used alternative assumptions:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((\mu_0,\sigma_0) = (y_0, 0)\)</span> which means  that <span class="math notranslate nohighlight">\(y_0\)</span> is  drawn from the distribution <span class="math notranslate nohighlight">\({\mathcal N}(y_0, 0)\)</span>; in effect, we are <strong>conditioning on an observed initial value</strong>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_0,\sigma_0\)</span> are functions of <span class="math notranslate nohighlight">\(\rho, \sigma_x\)</span> because <span class="math notranslate nohighlight">\(y_0\)</span> is drawn from the stationary distribution implied by <span class="math notranslate nohighlight">\(\rho, \sigma_x\)</span>.</p></li>
</ul>
<p><strong>Note:</strong> We do <strong>not</strong> treat a third possible case in which  <span class="math notranslate nohighlight">\(\mu_0,\sigma_0\)</span> are free parameters to be estimated.</p>
<p>Unknown parameters are <span class="math notranslate nohighlight">\(\rho, \sigma_x\)</span>.</p>
<p>We have  independent <strong>prior probability distributions</strong> for <span class="math notranslate nohighlight">\(\rho, \sigma_x\)</span> and want to compute a posterior probability distribution after observing a sample <span class="math notranslate nohighlight">\(\{y_{t}\}_{t=0}^T\)</span>.</p>
<p>The notebook uses <code class="docutils literal notranslate"><span class="pre">pymc4</span></code> and <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to compute a posterior distribution of <span class="math notranslate nohighlight">\(\rho, \sigma_x\)</span>. We will use NUTS samplers to generate samples from the posterior in a chain. Both of these libraries support NUTS samplers.</p>
<p>NUTS is a form of Monte Carlo Markov Chain (MCMC) algorithm that bypasses random walk behaviour and allows for convergence to a target distribution more quickly. This not only has the advantage of speed, but allows for complex models to be fitted without having to employ specialised knowledge regarding the theory underlying those fitting methods.</p>
<p>Thus, we explore consequences of making these alternative assumptions about the distribution of <span class="math notranslate nohighlight">\(y_0\)</span>:</p>
<ul class="simple">
<li><p>A first procedure is to condition on whatever value of <span class="math notranslate nohighlight">\(y_0\)</span> is observed. This amounts to assuming that the probability distribution of the random variable  <span class="math notranslate nohighlight">\(y_0\)</span> is a Dirac delta function that puts probability one on the observed value of <span class="math notranslate nohighlight">\(y_0\)</span>.</p></li>
<li><p>A second procedure  assumes that <span class="math notranslate nohighlight">\(y_0\)</span> is drawn from the stationary distribution of a process described by <a class="reference internal" href="#equation-eq-themodel">(9.1)</a>
so that  <span class="math notranslate nohighlight">\(y_0 \sim {\cal N} \left(0, {\sigma_x^2\over (1-\rho)^2} \right) \)</span></p></li>
</ul>
<p>When the initial value <span class="math notranslate nohighlight">\(y_0\)</span> is far out in a tail of the stationary distribution, conditioning on an initial value gives a posterior that is <strong>more accurate</strong> in a sense that we’ll explain.</p>
<p>Basically, when <span class="math notranslate nohighlight">\(y_0\)</span> happens to be  in a tail of the stationary distribution and we <strong>don’t condition on <span class="math notranslate nohighlight">\(y_0\)</span></strong>, the likelihood function for <span class="math notranslate nohighlight">\(\{y_t\}_{t=0}^T\)</span> adjusts the posterior distribution of the parameter pair <span class="math notranslate nohighlight">\(\rho, \sigma_x \)</span> to make the observed value of <span class="math notranslate nohighlight">\(y_0\)</span>  more likely than it really is under the stationary distribution, thereby adversely twisting the posterior in short samples.</p>
<p>An example below shows how not conditioning on <span class="math notranslate nohighlight">\(y_0\)</span> adversely shifts the posterior probability distribution of <span class="math notranslate nohighlight">\(\rho\)</span> toward larger values.</p>
<p>We begin by solving a <strong>direct problem</strong> that simulates an AR(1) process.</p>
<p>How we select the initial value <span class="math notranslate nohighlight">\(y_0\)</span> matters.</p>
<ul class="simple">
<li><p>If we think <span class="math notranslate nohighlight">\(y_0\)</span> is drawn from the stationary distribution <span class="math notranslate nohighlight">\({\mathcal N}(0, \frac{\sigma_x^{2}}{1-\rho^2})\)</span>, then it is a good idea to use this distribution as <span class="math notranslate nohighlight">\(f(y_0)\)</span>.  Why? Because <span class="math notranslate nohighlight">\(y_0\)</span> contains information about <span class="math notranslate nohighlight">\(\rho, \sigma_x\)</span>.</p></li>
<li><p>If we suspect that <span class="math notranslate nohighlight">\(y_0\)</span> is far in the tails of the stationary distribution – so that variation in early observations in the sample have a significant <strong>transient component</strong> – it is better to condition on <span class="math notranslate nohighlight">\(y_0\)</span> by setting <span class="math notranslate nohighlight">\(f(y_0) = 1\)</span>.</p></li>
</ul>
<p>To illustrate the issue, we’ll begin by choosing an initial <span class="math notranslate nohighlight">\(y_0\)</span> that is far out in a tail of the stationary distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ar1_simulate</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>

    <span class="c1"># Allocate space and draw epsilons</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>

    <span class="c1"># Initial condition and step forward</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">eps</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">y</span>

<span class="n">sigma</span> <span class="o">=</span>  <span class="mf">1.</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">145353452</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ar1_simulate</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c24c89db97d5be1b6a3f981a0837162428ba962306d5e95f5c46695a4a506cb1.png" src="_images/c24c89db97d5be1b6a3f981a0837162428ba962306d5e95f5c46695a4a506cb1.png" />
</div>
</div>
<p>Now we shall use Bayes’ law to construct a posterior distribution, conditioning on the initial value of <span class="math notranslate nohighlight">\(y_0\)</span>.</p>
<p>(Later we’ll assume that <span class="math notranslate nohighlight">\(y_0\)</span> is drawn from the stationary distribution, but not now.)</p>
<p>First we’ll use <strong>pymc4</strong>.</p>
<section id="pymc-implementation">
<h2><span class="section-number">9.1. </span>PyMC Implementation<a class="headerlink" href="#pymc-implementation" title="Permalink to this heading">#</a></h2>
<p>For a normal distribution in <code class="docutils literal notranslate"><span class="pre">pymc</span></code>,
<span class="math notranslate nohighlight">\(var = 1/\tau = \sigma^{2}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AR1_model</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

<span class="k">with</span> <span class="n">AR1_model</span><span class="p">:</span>

    <span class="c1"># Start with priors</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span> <span class="c1"># Assume stable rho</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Expected value of y at the next period (rho * y)</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Likelihood of the actual realization</span>
    <span class="n">y_like</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;y_obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://www.pymc.io/projects/docs/en/v5.10.0/api/generated/pymc.sample.html#pymc-sample">pmc.sample</a> by default uses the NUTS samplers to generate samples as shown in the below cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">AR1_model</span><span class="p">:</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">50000</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='240000' class='' max='240000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [240000/240000 01:26&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages/arviz/utils.py:184: NumbaDeprecationWarning: <span class=" -Color -Color-Bold">The &#39;nopython&#39; keyword argument was not supplied to the &#39;numba.jit&#39; decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.</span>
  numba_fn = numba.jit(**self.kwargs)(self.function)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">AR1_model</span><span class="p">:</span>
    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/humphreyyang/anaconda3/envs/quantecon_test/lib/python3.10/site-packages/arviz/utils.py:184: NumbaDeprecationWarning: <span class=" -Color -Color-Bold">The &#39;nopython&#39; keyword argument was not supplied to the &#39;numba.jit&#39; decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.</span>
  numba_fn = numba.jit(**self.kwargs)(self.function)
</pre></div>
</div>
<img alt="_images/1776d2cc63196e620726e6ac30fb7fff10326e6d5ece6edc3ffbb34559e590ed.png" src="_images/1776d2cc63196e620726e6ac30fb7fff10326e6d5ece6edc3ffbb34559e590ed.png" />
</div>
</div>
<p>Evidently, the posteriors aren’t centered on the true values of <span class="math notranslate nohighlight">\(.5, 1\)</span> that we used to generate the data.</p>
<p>This is a symptom of the classic <strong>Hurwicz bias</strong> for first order autoregressive processes (see Leonid Hurwicz <span id="id1">[<a class="reference internal" href="zreferences.html#id244" title="Leonid Hurwicz. Least squares bias in time series. Statistical inference in dynamic economic models, 10:365–383, 1950.">Hur50</a>]</span>.)</p>
<p>The Hurwicz bias is worse the smaller is the sample (see <span id="id2">[<a class="reference internal" href="zreferences.html#id243" title="Guy H. Orcutt and Herbert S. Winokur. First order autoregression: inference, estimation, and prediction. Econometrica, 37(1):1–14, 1969.">OW69</a>]</span>).</p>
<p>Be that as it may, here is more information about the posterior.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">AR1_model</span><span class="p">:</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rho</th>
      <td>0.5361</td>
      <td>0.0709</td>
      <td>0.4003</td>
      <td>0.6679</td>
      <td>0.0002</td>
      <td>0.0001</td>
      <td>177625.6411</td>
      <td>124240.6983</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>1.0103</td>
      <td>0.1064</td>
      <td>0.8175</td>
      <td>1.2105</td>
      <td>0.0003</td>
      <td>0.0002</td>
      <td>180151.5908</td>
      <td>140894.6331</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we shall compute a posterior distribution after seeing the same data but instead assuming that <span class="math notranslate nohighlight">\(y_0\)</span> is drawn from the stationary distribution.</p>
<p>This means that</p>
<div class="math notranslate nohighlight">
\[
y_0 \sim N \left(0, \frac{\sigma_x^{2}}{1 - \rho^{2}} \right)
\]</div>
<p>We alter the code as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AR1_model_y0</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

<span class="k">with</span> <span class="n">AR1_model_y0</span><span class="p">:</span>

    <span class="c1"># Start with priors</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span> <span class="c1"># Assume stable rho</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

    <span class="c1"># Standard deviation of ergodic y</span>
    <span class="n">y_sd</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># yhat</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;y_obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">y0_data</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;y0_obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">y_sd</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">AR1_model_y0</span><span class="p">:</span>
    <span class="n">trace_y0</span> <span class="o">=</span> <span class="n">pmc</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">50000</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Grey vertical lines are the cases of divergence</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='240000' class='' max='240000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [240000/240000 01:28&lt;00:00 Sampling 4 chains, 69 divergences]
    </div>
    </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">AR1_model_y0</span><span class="p">:</span>
    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_y0</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dfe53c87bcef22de18cbe6d19d0909a7fac50cd3af7bde49b4832fd522424511.png" src="_images/dfe53c87bcef22de18cbe6d19d0909a7fac50cd3af7bde49b4832fd522424511.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">AR1_model</span><span class="p">:</span>
    <span class="n">summary_y0</span> <span class="o">=</span> <span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace_y0</span><span class="p">,</span> <span class="n">round_to</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">summary_y0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rho</th>
      <td>0.8760</td>
      <td>0.0816</td>
      <td>0.7315</td>
      <td>0.9995</td>
      <td>0.0002</td>
      <td>0.0002</td>
      <td>107739.5117</td>
      <td>78568.8757</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>sigma</th>
      <td>1.4046</td>
      <td>0.1473</td>
      <td>1.1410</td>
      <td>1.6831</td>
      <td>0.0004</td>
      <td>0.0003</td>
      <td>127554.9004</td>
      <td>104906.9737</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Please note how the posterior for <span class="math notranslate nohighlight">\(\rho\)</span> has shifted to the right relative to when we conditioned on <span class="math notranslate nohighlight">\(y_0\)</span> instead of assuming that <span class="math notranslate nohighlight">\(y_0\)</span> is drawn from the stationary distribution.</p>
<p>Think about why this happens.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>It is connected to how Bayes Law (conditional probability) solves an <strong>inverse problem</strong> by putting high probability on parameter values
that make observations more likely.</p>
</div>
<p>We’ll return to this issue after we use <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to compute posteriors under our two alternative assumptions about the distribution of <span class="math notranslate nohighlight">\(y_0\)</span>.</p>
<p>We’ll now repeat the calculations using <code class="docutils literal notranslate"><span class="pre">numpyro</span></code>.</p>
</section>
<section id="numpyro-implementation">
<h2><span class="section-number">9.2. </span>Numpyro Implementation<a class="headerlink" href="#numpyro-implementation" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_posterior</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot trace and histogram</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># To np array</span>
    <span class="n">rhos</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span>
    <span class="n">sigmas</span> <span class="o">=</span> <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span>
    <span class="n">rhos</span><span class="p">,</span> <span class="n">sigmas</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rhos</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sigmas</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="c1"># Plot trace</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rhos</span><span class="p">)</span>   <span class="c1"># rho</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sigmas</span><span class="p">)</span> <span class="c1"># sigma</span>

    <span class="c1"># Plot posterior</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">sigmas</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;rho&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;rho&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">AR1_model</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># set prior</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>

    <span class="c1"># Expected value of y at the next period (rho * y)</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Likelihood of the actual realization.</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s1">&#39;y_obs&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make jnp array</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Set NUTS kernal</span>
<span class="n">NUTS_kernel</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">infer</span><span class="o">.</span><span class="n">NUTS</span><span class="p">(</span><span class="n">AR1_model</span><span class="p">)</span>

<span class="c1"># Run MCMC</span>
<span class="n">mcmc</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">infer</span><span class="o">.</span><span class="n">MCMC</span><span class="p">(</span><span class="n">NUTS_kernel</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">num_warmup</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mcmc</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rng_key</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">mcmc</span><span class="o">.</span><span class="n">get_samples</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2df0dda826799a1dd911314d062029a1581233ed260b012094b65938a73b5104.png" src="_images/2df0dda826799a1dd911314d062029a1581233ed260b012094b65938a73b5104.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                mean       std    median      5.0%     95.0%     n_eff     r_hat
       rho      0.54      0.07      0.54      0.42      0.65  31483.32      1.00
     sigma      1.01      0.11      1.00      0.84      1.18  32669.54      1.00

Number of divergences: 0
</pre></div>
</div>
</div>
</div>
<p>Next, we again compute the posterior under the assumption that <span class="math notranslate nohighlight">\(y_0\)</span> is drawn from the stationary distribution, so that</p>
<div class="math notranslate nohighlight">
\[
y_0 \sim N \left(0, \frac{\sigma_x^{2}}{1 - \rho^{2}} \right)
\]</div>
<p>Here’s the new code to achieve this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">AR1_model_y0</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># Set prior</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.</span><span class="p">))</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>

    <span class="c1"># Standard deviation of ergodic y</span>
    <span class="n">y_sd</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Expected value of y at the next period (rho * y)</span>
    <span class="n">yhat</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Likelihood of the actual realization.</span>
    <span class="n">y_data</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s1">&#39;y_obs&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">yhat</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">y0_data</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s1">&#39;y0_obs&#39;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">y_sd</span><span class="p">),</span> <span class="n">obs</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make jnp array</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Set NUTS kernal</span>
<span class="n">NUTS_kernel</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">infer</span><span class="o">.</span><span class="n">NUTS</span><span class="p">(</span><span class="n">AR1_model_y0</span><span class="p">)</span>

<span class="c1"># Run MCMC</span>
<span class="n">mcmc2</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">infer</span><span class="o">.</span><span class="n">MCMC</span><span class="p">(</span><span class="n">NUTS_kernel</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">num_warmup</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">mcmc2</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rng_key</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">mcmc2</span><span class="o">.</span><span class="n">get_samples</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7c21474e044d2074fce87e1db67179a59c7e325e8f234d4e0869f0dfbc27ccd2.png" src="_images/7c21474e044d2074fce87e1db67179a59c7e325e8f234d4e0869f0dfbc27ccd2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mcmc2</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                mean       std    median      5.0%     95.0%     n_eff     r_hat
       rho      0.88      0.08      0.89      0.76      1.00  27638.50      1.00
     sigma      1.40      0.15      1.39      1.17      1.64  24358.14      1.00

Number of divergences: 0
</pre></div>
</div>
</div>
</div>
<p>Look what happened to the posterior!</p>
<p>It has moved far from the true values of the parameters used to generate the data because of how Bayes’ Law (i.e., conditional probability)
is telling <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to explain what it interprets as  “explosive” observations early in the sample.</p>
<p>Bayes’ Law is able to generate a plausible likelihood for the first observation by driving <span class="math notranslate nohighlight">\(\rho \rightarrow 1\)</span> and <span class="math notranslate nohighlight">\(\sigma \uparrow\)</span> in order to raise the variance of the stationary distribution.</p>
<p>Our example illustrates the importance of what you assume about the distribution of initial conditions.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementary Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   1. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   2. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   3. Maximum Likelihood Estimation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   4. Elementary Probability with Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   5. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   6. Multivariate Normal Distribution
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Information &amp; Bayesian Statistics
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   7. Two Meanings of Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   8. Non-Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   9. Posterior Distributions for  AR(1) Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   10. Forecasting  an AR(1) Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   11. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   12. Computing Mean of a Likelihood Ratio Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   13. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   14. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   15. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   16. Incorrect Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   17. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications of Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   18. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   19. Fault Tree Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   20. Introduction to Artificial Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   21. Randomized Response Surveys
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   22. Expected Utilities of Random Responses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   23. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   24. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   25. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li data-tippy-content="Download PDF" onClick="window.print()"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/ar1_bayes.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/master/ar1_bayes.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/ar1_bayes.ipynb" data-branch=master>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/master/ar1_bayes.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "ar1_bayes";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/ar1_bayes.ipynb";
                const branch = "master"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>